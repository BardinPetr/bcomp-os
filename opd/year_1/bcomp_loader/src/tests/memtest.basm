ORG 0x10

INCLUDE util/math.basm
INCLUDE util/string.basm
INCLUDE io/output.basm
INCLUDE io/input.basm
INCLUDE os/memory.basm

JUMP_TARGET: WORD ?
LENS: WORD 0x4, 0x5, 0x6, 0x7, 0x8, 0x2
LENSP: WORD $LENS
ALCS: WORD 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
ALCSP: WORD $ALCS
START:
  LD (LENSP)+
  CALL $MALLOC
  ST (ALCSP)+

  LD (LENSP)+
  CALL $MALLOC
  ST (ALCSP)+

  LD (LENSP)+
  CALL $MALLOC
  ST (ALCSP)+

  LD -(ALCSP)
  CALL $MFREE

  LD -(ALCSP)
  CALL $MFREE

  LD (LENSP)+
  CALL $MALLOC
  ST (ALCSP)+

  LD (LENSP)+
  CALL $MALLOC
  ST (ALCSP)+

  LD -(ALCSP)
  CALL $MFREE

  LD -(ALCSP)
  CALL $MFREE

  LD -(ALCSP)
  CALL $MFREE


  LD (LENSP)+
  CALL $MALLOC

  HLT
  
_SYS_CODE_END_PTR: WORD 0

; begin globals
ORG 0x700
_SYS_HEAP: WORD 224 DUP (0x0)
; end globals
